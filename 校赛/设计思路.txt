========================== 绿色弹丸识别与计数系统设计思路 ===============================

1. 读取输入图像，检查文件有效性
2. 颜色分割生成初始掩膜，经形态学操作优化
3. 层级过滤剔除复杂杂物，得到纯净弹丸候选区域
4. 距离变换突出弹丸中心，筛选并合并标记点
5. 基于标记点执行分水岭分割，分离粘连弹丸
6. 校准基准弹丸半径，确定筛选模式
7. 按双模式筛选有效弹丸，去重后统计数量
8. 保存中间结果和带标注的最终结果
9. 批量处理完成后，关闭所有窗口，输出处理总结

============================ 具体细节 ===============================================

1.弹丸粘连        腐蚀造缝隙+分水岭分割，通过标记点引导分割，实现粘连分离
2.背景杂物干扰     颜色分割+层级过滤+面积筛选，多重过滤非绿色、多层级、超大/超小的杂物
3.光照变化影响     采用HSV颜色空间分割，降低光照，带灰尘白球对颜色识别的影响       
4.弹丸个体差异     基准校准+半径容差，适配不同弹丸的尺寸波动
5.分割碎片干扰     提取最大轮廓+小面积过滤，剔除分割产生的无效碎片
6.重复计数        基于中心距离的去重逻辑，确保同一弹丸仅计数一次     


============================ 设计亮点 ==================================================

1.双模式适配：支持基准模式与掩膜模式自动切换，在有规则弹丸的场景下用基准模式提升精度，在无基准的场景下用掩膜模式保证功能可用
2.针对复杂背景中存在的多层级杂物（如屌丝饮料，纸抽），设计层级过滤
3.冈萨雷斯版分水岭算法分割粘连弹丸

============================ 参考学习资料 ===============================================

1.    https://www.bilibili.com/video/BV1HM8we3EHo/?share_source=copy_web&vd_source=617ba246736a3389916d2e78fd703b9c
2.    https://zhuanlan.zhihu.com/p/344780050